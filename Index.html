<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Area Report</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        table { width: 80%; margin: auto; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

    <h1>Upload Employee Excel File</h1>
    <input type="file" id="fileInput" accept=".xlsx">
    <br><br>
    <table id="employeeTable">
        <thead>
            <tr>
                <th>Area</th>
                <th>Employee Count</th>
                <th>Vehicle Type</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        document.getElementById("fileInput").addEventListener("change", function(event) {
            let file = event.target.files[0];
            if (!file) return;

            let reader = new FileReader();
            reader.readAsBinaryString(file);

            reader.onload = function(e) {
                let data = e.target.result;
                let workbook = XLSX.read(data, { type: "binary" });
                let sheetName = workbook.SheetNames[0];
                let sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

                processEmployeeData(sheet);
            };
        });

        function processEmployeeData(data) {
            let areaCounts = {};

            // Count employees per area
            data.forEach(row => {
                let area = row["Area"];
                if (!areaCounts[area]) {
                    areaCounts[area] = 0;
                }
                areaCounts[area]++;
            });

            // Suggest vehicle based on count
            let result = Object.entries(areaCounts).map(([area, count]) => {
                return {
                    area,
                    count,
                    vehicle: suggestVehicle(count)
                };
            });

            displayTable(result);
        }

        function suggestVehicle(count) {
            if (count <= 2) return "Bike";
            if (count <= 5) return "Car";
            if (count <= 15) return "Van";
            return "Bus";
        }

        function displayTable(data) {
            let tbody = document.querySelector("#employeeTable tbody");
            tbody.innerHTML = ""; // Clear previous data

            data.forEach(row => {
                let tr = document.createElement("tr");
                tr.innerHTML = `<td>${row.area}</td><td>${row.count}</td><td>${row.vehicle}</td>`;
                tbody.appendChild(tr);
            });
        }
    </script>

</body>
</html>
